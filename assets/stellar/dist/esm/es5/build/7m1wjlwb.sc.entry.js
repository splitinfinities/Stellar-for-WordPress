import*as tslib_1 from"../polyfills/tslib.js";import{a as assert}from"./chunk-ee695030.js";var buildBiquadFilterNode=function(e,t){var i=e.createBiquadFilter();return i.type=t.method,i.gain.value=1,responsiveTo(i,t),i},buildDelayNode=function(e,t){var i=e.createDelay(5);return i.delayTime.value=3,responsiveTo(i,t),i},buildReverbNode=function(e,t){return tslib_1.__awaiter(this,void 0,void 0,function(){var i,o;return tslib_1.__generator(this,function(n){switch(n.label){case 0:return i=e.createConvolver(),[4,t._use.getBuffer()];case 1:return(o=n.sent())&&(i.buffer=o),[2,i]}})})},responsiveTo=function(e,t){!1!==t.midicontroller?biquadResponsiveToMidi(e,t):"mouse"===t.responds?biquadResponsiveToMouse(e,t):e.frequency.value=t.value},handleMouseMove=function(e){var t,i,o;return null==(e=e||window.event).pageX&&null!=e.clientX&&(o=(t=e.target&&e.target.ownerDocument||document).body,e.pageX=e.clientX+((i=t.documentElement)&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),{toTop:e.pageY,toRight:window.innerWidth-e.pageX,toBottom:window.innerHeight-e.pageY,toLeft:e.pageX}},getMousePosition=function(){if(window.mousePos){var e=new CustomEvent("mouse-update",{detail:window.mousePos});document.dispatchEvent(e)}},biquadResponsiveToMidi=function(e,t){document.addEventListener("midi-controller-update",function(i){t.midicontroller===i.detail.controller.number&&(e.frequency.value=(i.detail.value+1)/128*3e3)})},biquadResponsiveToMouse=function(e,t){document.addEventListener("mouse-update",function(i){"x"===t.axis?e.frequency.value=1.5*i.detail.toLeft||1e3:"x-reverse"===t.axis?e.frequency.value=1.5*i.detail.toRight||1e3:"y"===t.axis?e.frequency.value=1.5*i.detail.toTop||1e3:"y-reverse"===t.axis?e.frequency.value=1.5*i.detail.toBottom||1e3:"bi"===t.axis?e.frequency.value=i.detail.toRight+i.detail.toTop||1e3:"bi-reverse"===t.axis&&(e.frequency.value=i.detail.toLeft+i.detail.toRight||1e3)},!1),window.mouseInitialized||(window.mouseInitialized=!0,document.onmousemove=handleMouseMove,setInterval(getMousePosition,100))},WebAudioEffect=function(){function e(){this.method="lowshelf",this.value=1,this.responds=null,this.midicontroller=0,this.axis="x"}return e.prototype.attachEffect=function(e,t){return tslib_1.__awaiter(this,void 0,void 0,function(){var i,o;return tslib_1.__generator(this,function(n){switch(n.label){case 0:return this.context=e,this.source=t,[4,t.webAudio()];case 1:return i=n.sent(),this._use=i.querySelector("web-audio-source[name="+this.use+"]"),assert(this.type,'"'+this.type+'" is not a valid effect - Routing around to masterGain."')&&"panner"!==this.type?[3,2]:[3,6];case 2:return"listener"!==this.type?[3,3]:[3,6];case 3:return"reverb"!==this.type?[3,5]:(o=this,[4,buildReverbNode(this.context,this)]);case 4:return o.effect=n.sent(),[3,6];case 5:"filter"===this.type?this.effect=buildBiquadFilterNode(this.context,this):"delay"===this.type&&(this.effect=buildDelayNode(this.context,this)),n.label=6;case 6:return[2,this.effect]}})})},e.prototype.effects=function(){return["panner","listener","reverb","delay","compression","distortion","filter"]},Object.defineProperty(e,"is",{get:function(){return"web-audio-effect"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"properties",{get:function(){return{_use:{state:!0},attachEffect:{method:!0},axis:{type:String,attr:"axis"},context:{state:!0},effect:{state:!0},element:{elementRef:!0},method:{type:String,attr:"method"},midicontroller:{type:Number,attr:"midicontroller"},parent:{state:!0},responds:{type:String,attr:"responds"},source:{state:!0},type:{type:String,attr:"type"},use:{type:String,attr:"use"},value:{type:Number,attr:"value"}}},enumerable:!0,configurable:!0}),e}();export{WebAudioEffect};