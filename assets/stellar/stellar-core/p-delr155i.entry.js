import{d as t,f as e}from"./p-1da3eb99.js";class s{constructor(e){t(this,e),this.name="web_audio_sequencer",this.autoplay=!1,this.taps=4,this.context=()=>document.querySelector("web-audio").get_context(),this.noteTime=0,this.currentTap=0,this.totalPlayTime=0,this.custom=()=>{}}componentDidLoad(){this.autoplay&&this.play()}schedule(){var t=this.context().currentTime;for(t-=this.startTime;this.noteTime<t+.005;)this.totalPlayTime=this.noteTime+this.startTime,0===this.currentTap&&this.iterations++,this.custom(),this.advance();this.timer=setTimeout(()=>{this.schedule()},0)}advance(){var t=60/this.tempo;this.currentTap++,this.currentTap==this.taps&&(this.currentTap=0),this.noteTime+=.25*t}async play(){this.context()||await document.querySelector("web-audio").connect_the_world(),this.iterations=0,this.startTime=this.context().currentTime+.005||.005,this.schedule()}async stop(){this.iterations=0,this.startTime=null,this.currentTap=0,clearTimeout(this.timer)}render(){return[e("button",{class:"play",onClick:()=>{this.play()}},"Play"),e("button",{class:"stop",onClick:()=>{this.stop()}},"Stop")]}}export{s as web_audio_sequencer};