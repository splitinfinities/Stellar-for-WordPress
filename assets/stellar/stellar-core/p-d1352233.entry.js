import{r as t,h as i,g as r}from"./p-378b4685.js";import{m as e,d as n}from"./p-5c97c18e.js";import"./p-c428ff15.js";import{p as s}from"./p-c93f133f.js";import"./p-22e0cac7.js";import"./p-3a3a4911.js";
/*
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 * License
 * -------
 * Copyright 2011, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 *
 * @license
 */
var o=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};o.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},o.prototype.update=function(t){this.context.putImageData(t,0,0)},o.prototype.getPixelCount=function(){return this.width*this.height},o.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},o.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var a=function(){};
/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 * @license
 */
/*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 * @license
 */
if(a.prototype.getColor=function(t,i){return this.getPalette(t,5,i)[0]},a.prototype.getPalette=function(t,i,r){(void 0===i||i<2||i>256)&&(i=10),(void 0===r||r<1)&&(r=10);for(var e,n,s,a,h=new o(t),c=h.getImageData().data,f=h.getPixelCount(),l=[],d=0;d<f;d+=r)n=c[0+(e=4*d)],s=c[e+1],a=c[e+2],c[e+3]>=125&&(n>250&&s>250&&a>250||l.push([n,s,a]));var g=u.quantize(l,i),p=g?g.palette():null;return h.removeCanvas(),p},a.prototype.getColorFromUrl=function(t,i,r){sourceImage=document.createElement("img");var e=this;sourceImage.addEventListener("load",(function(){var n=e.getPalette(sourceImage,5,r);i(n[0],t)})),sourceImage.src=t},a.prototype.getImageData=function(t,i){xhr=new XMLHttpRequest,xhr.open("GET",t,!0),xhr.responseType="arraybuffer",xhr.onload=function(){if(200==this.status){uInt8Array=new Uint8Array(this.response),t=uInt8Array.length,binaryString=new Array(t);for(var t=0;t<uInt8Array.length;t++)binaryString[t]=String.fromCharCode(uInt8Array[t]);data=binaryString.join(""),base64=window.btoa(data),i("data:image/png;base64,"+base64)}},xhr.send()},a.prototype.getColorAsync=function(t,i,r){var e=this;this.getImageData(t,(function(t){sourceImage=document.createElement("img"),sourceImage.addEventListener("load",(function(){var t=e.getPalette(sourceImage,5,r);i(t[0],this)})),sourceImage.src=t}))},!h)var h={map:function(t,i){var r={};return i?t.map((function(t,e){return r.index=e,i.call(r,t)})):t.slice()},naturalOrder:function(t,i){return t<i?-1:t>i?1:0},sum:function(t,i){var r={};return t.reduce(i?function(t,e,n){return r.index=n,t+i.call(r,e)}:function(t,i){return t+i},0)},max:function(t,i){return Math.max.apply(null,i?h.map(t,i):t)}};var u=function(){function t(t,i,r){return(t<<10)+(i<<5)+r}function i(t){var i=[],r=!1;function e(){i.sort(t),r=!0}return{push:function(t){i.push(t),r=!1},peek:function(t){return r||e(),void 0===t&&(t=i.length-1),i[t]},pop:function(){return r||e(),i.pop()},size:function(){return i.length},map:function(t){return i.map(t)},debug:function(){return r||e(),i}}}function r(t,i,r,e,n,s,o){this.r1=t,this.r2=i,this.g1=r,this.g2=e,this.b1=n,this.b2=s,this.histo=o}function e(){this.vboxes=new i((function(t,i){return h.naturalOrder(t.vbox.count()*t.vbox.volume(),i.vbox.count()*i.vbox.volume())}))}function n(i,r){if(r.count()){var e=r.r2-r.r1+1,n=r.g2-r.g1+1,s=h.max([e,n,r.b2-r.b1+1]);if(1==r.count())return[r.copy()];var o,a,u,c,f=0,l=[],d=[];if(s==e)for(o=r.r1;o<=r.r2;o++){for(c=0,a=r.g1;a<=r.g2;a++)for(u=r.b1;u<=r.b2;u++)c+=i[t(o,a,u)]||0;l[o]=f+=c}else if(s==n)for(o=r.g1;o<=r.g2;o++){for(c=0,a=r.r1;a<=r.r2;a++)for(u=r.b1;u<=r.b2;u++)c+=i[t(a,o,u)]||0;l[o]=f+=c}else for(o=r.b1;o<=r.b2;o++){for(c=0,a=r.r1;a<=r.r2;a++)for(u=r.g1;u<=r.g2;u++)c+=i[t(a,u,o)]||0;l[o]=f+=c}return l.forEach((function(t,i){d[i]=f-t})),function(t){var i,e,n,s,a,h=t+"1",u=t+"2",c=0;for(o=r[h];o<=r[u];o++)if(l[o]>f/2){for(n=r.copy(),s=r.copy(),a=(i=o-r[h])<=(e=r[u]-o)?Math.min(r[u]-1,~~(o+e/2)):Math.max(r[h],~~(o-1-i/2));!l[a];)a++;for(c=d[a];!c&&l[a-1];)c=d[--a];return n[u]=a,s[h]=n[u]+1,[n,s]}}(s==e?"r":s==n?"g":"b")}}return r.prototype={volume:function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(i){var r=this.histo;if(!this._count_set||i){var e,n,s,o=0;for(e=this.r1;e<=this.r2;e++)for(n=this.g1;n<=this.g2;n++)for(s=this.b1;s<=this.b2;s++)o+=r[t(e,n,s)]||0;this._count=o,this._count_set=!0}return this._count},copy:function(){return new r(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(i){var r=this.histo;if(!this._avg||i){var e,n,s,o,a=0,h=0,u=0,c=0;for(n=this.r1;n<=this.r2;n++)for(s=this.g1;s<=this.g2;s++)for(o=this.b1;o<=this.b2;o++)a+=e=r[t(n,s,o)]||0,h+=e*(n+.5)*8,u+=e*(s+.5)*8,c+=e*(o+.5)*8;this._avg=a?[~~(h/a),~~(u/a),~~(c/a)]:[~~(8*(this.r1+this.r2+1)/2),~~(8*(this.g1+this.g2+1)/2),~~(8*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(t){var i=t[0]>>3;return gval=t[1]>>3,bval=t[2]>>3,i>=this.r1&&i<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},e.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var i=this.vboxes,r=0;r<i.size();r++)if(i.peek(r).vbox.contains(t))return i.peek(r).color;return this.nearest(t)},nearest:function(t){for(var i,r,e,n=this.vboxes,s=0;s<n.size();s++)((r=Math.sqrt(Math.pow(t[0]-n.peek(s).color[0],2)+Math.pow(t[1]-n.peek(s).color[1],2)+Math.pow(t[2]-n.peek(s).color[2],2)))<i||void 0===i)&&(i=r,e=n.peek(s).color);return e},forcebw:function(){var t=this.vboxes;t.sort((function(t,i){return h.naturalOrder(h.sum(t.color),h.sum(i.color))}));var i=t[0].color;i[0]<5&&i[1]<5&&i[2]<5&&(t[0].color=[0,0,0]);var r=t.length-1,e=t[r].color;e[0]>251&&e[1]>251&&e[2]>251&&(t[r].color=[255,255,255])}},{quantize:function(s,o){if(!s.length||o<2||o>256)return!1;var a=function(i){var r,e=new Array(32768);return i.forEach((function(i){r=t(i[0]>>3,i[1]>>3,i[2]>>3),e[r]=(e[r]||0)+1})),e}(s);a.forEach((function(){}));var u=function(t,i){var e,n,s,o=1e6,a=0,h=1e6,u=0,c=1e6,f=0;return t.forEach((function(t){(e=t[0]>>3)<o?o=e:e>a&&(a=e),(n=t[1]>>3)<h?h=n:n>u&&(u=n),(s=t[2]>>3)<c?c=s:s>f&&(f=s)})),new r(o,a,h,u,c,f,i)}(s,a),c=new i((function(t,i){return h.naturalOrder(t.count(),i.count())}));function f(t,i){for(var r,e=1,s=0;s<1e3;)if((r=t.pop()).count()){var o=n(a,r),h=o[0],u=o[1];if(!h)return;if(t.push(h),u&&(t.push(u),e++),e>=i)return;if(s++>1e3)return}else t.push(r),s++}c.push(u),f(c,.75*o);for(var l=new i((function(t,i){return h.naturalOrder(t.count()*t.volume(),i.count()*i.volume())}));c.size();)l.push(c.pop());f(l,o-l.size());for(var d=new e;l.size();)d.push(l.pop());return d}}}();const c=class{constructor(i){t(this,i),this.type="picture",this.nozoom=!1,this.block=!1,this.bg="auto",this.alt="",this.sources=[],this.active=!1}componentWillLoad(){this.prepareSources(),this.setBG(),this.updateAspectRatio()}componentDidLoad(){this.figure=this.element.shadowRoot.querySelector("figure")}mountZoom(){let t=this.element.shadowRoot.querySelector("img");this.zoom=e(t,{background:`${this.bg}`,scrollOffset:1,margin:30})}handlePosterChange(){this.setBG()}handleActive(){this.setBackgroundImage()}async medium(){return this.zoom}async in(){this.active=!0,this.nozoom||(await n(200),this.mountZoom())}getPictureColor(){if(window.Image){const t=new Image(80,80);t.addEventListener("load",()=>{const i=new a;this.palette=i.getColor(t),s.set({"--background-color":`rgb(${this.palette[0]}, ${this.palette[1]}, ${this.palette[2]})`},this.element),this.bg=`rgb(${this.palette[0]}, ${this.palette[1]}, ${this.palette[2]})`,this.zoom&&this.zoom.update({background:this.bg})},!1),t.src=this.poster,t.crossOrigin="Anonymous"}}setBG(){"auto"===this.bg?this.getPictureColor():s.set({"--background-color":`${this.bg}`},this.element)}prepareSources(){const t=this.element.querySelectorAll("source");let i=[];[].forEach.call(t,t=>{i=[...i,t],t.hidden=!0}),this.sources=i,this.poster=this.poster?this.poster:this.sources[this.sources.length-1].srcset,this.large=this.sources[0].srcset,this.setBackgroundImage()}setBackgroundImage(){s.set({"--background-image":`url('${this.active?this.large:this.poster}')`},this.element)}updateAspectRatio(){this.aspectRatio=this.height/this.width*100,s.set({"--aspect-ratio":`${this.aspectRatio}%`,"--width":`${this.width}px`,"--height":`${this.height}px`},this.element)}renderPicture(){if(this.active)return[this.sources.map(t=>i("source",{srcSet:t.srcset,media:!!t.media&&t.media})),i("img",{src:this.large,class:"final_image",alt:this.alt})]}render(){return"picture"===this.type?i("figure",{itemtype:"http://schema.org/ImageObject",class:this.active?"loaded":"",onClick:()=>{this.zoom&&this.zoom.open()}},i("div",{class:"overlay"}),i("picture",null,this.renderPicture()),i("div",{class:"placeholder",style:{"background-image":`url(${this.poster})`}}),i("stellar-intersection",{element:this.element,in:this.in.bind(this)})):i("stellar-intersection",{element:this.element,in:this.in.bind(this)})}static get assetsDirs(){return["./vendor"]}get element(){return r(this)}static get watchers(){return{poster:["handlePosterChange"],active:["handleActive"]}}static get style(){return':host,:host *,:host *:before,:host *:after{-webkit-box-sizing:border-box;box-sizing:border-box}:host{--filter:blur(10px);--background-color:transparent;--aspect-ratio:100%;--ease:ease-in-out;--gradient:none;--blend:multiply;--initial-opacity:1;--speed:0.85s;--figure-height:0;contain:content;display:-ms-inline-flexbox;display:inline-flex;background:var(--background-color);width:100%;max-width:var(--width, 300px);max-height:var(--height, 300px);-ms-flex-align:center;align-items:center}:host([type="background"]){background-color:var(--background-color);background-image:var(--background-image);background-size:cover;background-repeat:no-repeat;height:100%;width:100%}:host([block]){display:-ms-flexbox;display:flex;--width:100% !important;--height:100% !important}:host figure{display:block;position:relative;margin:0;padding-bottom:var(--aspect-ratio);width:100%;height:var(--figure-height);cursor:-webkit-zoom-in;cursor:zoom-in;-webkit-transition:all 200ms var(--ease) 0s;transition:all 200ms var(--ease) 0s}:host figure:hover,:host figure:focus{-webkit-transform:scale(1.025);transform:scale(1.025)}:host([nozoom]) figure{-webkit-transform:none !important;transform:none !important;cursor:inherit !important}:host figure:active{-webkit-transform:scale(0.975);transform:scale(0.975)}:host picture,:host img.placeholder,:host .overlay{position:absolute;top:0;left:0;-webkit-transition:all var(--speed) cubic-bezier(0.2, 0.3, 0.25, 0.9) 1s;transition:all var(--speed) cubic-bezier(0.2, 0.3, 0.25, 0.9) 1s;width:100%;height:100%;overflow:hidden}:host .overlay{opacity:0.5;z-index:3;pointer-events:none;background:var(--gradient);mix-blend-mode:var(--blend)}:host picture{-webkit-transition:all var(--speed) cubic-bezier(0.2, 0.3, 0.25, 0.9) 1s;transition:all var(--speed) cubic-bezier(0.2, 0.3, 0.25, 0.9) 1s;opacity:0;z-index:2}:host picture img.final_image{display:block;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}:host .placeholder{position:absolute;width:100%;height:100%;pointer-events:none;opacity:var(--initial-opacity);z-index:1;background:var(--background-color) 50% 50% / cover no-repeat;-webkit-filter:var(--filter);filter:var(--filter);image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor;-webkit-transition:all var(--speed) cubic-bezier(0.2, 0.3, 0.25, 0.9) 1s;transition:all var(--speed) cubic-bezier(0.2, 0.3, 0.25, 0.9) 1s}:host figure.loaded picture{opacity:1}:host figure.loaded .placeholder{-webkit-filter:none;filter:none;opacity:0}:host figure.loaded .overlay{opacity:0.3}'}};export{c as stellar_image};