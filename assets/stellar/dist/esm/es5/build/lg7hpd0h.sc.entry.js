import*as tslib_1 from"../polyfills/tslib.js";import{h}from"../stellar-core.core.js";var style={iconStyle:"solid",base:{iconColor:"#484849",color:"#484849",fontWeight:500,fontFamily:"Open Sans, sans-serif",fontSize:"15px",fontSmoothing:"antialiased","::placeholder":{color:"#a3a3a4"},":-webkit-autofill":{color:"#a3a3a4"}},invalid:{iconColor:"#f85e5a",color:"#f85e5a","::placeholder":{color:"#fa8e8b"}}},classes={focus:"focused",empty:"empty",invalid:"invalid"},Card=function(){function t(){this.token="pk_test_6pRNASCoBOKtIshFeQd4XMUh",this.name="stripe",this.value=void 0,this.cardData={},this.state="preparing"}return t.prototype.componentWillLoad=function(){this.stripe=window.Stripe(this.token)},t.prototype.componentDidLoad=function(){this.connect()},t.prototype.connect=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return this.stripe=window.Stripe(this.token),this.input=this.element.querySelector(".token"),this.attachToForm(),this.prepareStripe(),[2]})})},t.prototype.getToken=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){switch(t.label){case 0:return[4,this.stripe.createToken(this.card,this.cardData).then(this.handleResponse.bind(this)).catch(this.handleError.bind(this))];case 1:return t.sent(),[2,void 0!==this.value]}})})},t.prototype.attachToForm=function(){var t=this,e=this.element.closest("form");e?e.addEventListener("submit",function(r){r.preventDefault(),t.getToken().then(function(t){t&&e.submit()})}):console.error("The stellar-stripe tag must be added to a form.")},t.prototype.handleResponse=function(t){var e=t.error,r=t.token;e?this.setError(e.message):(this.error=void 0,this.value=r.id)},t.prototype.handleError=function(t){this.setError(t.message)},t.prototype.setError=function(t){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(e){return this.error=t,[2]})})},t.prototype.prepareStripe=function(){var t=this.stripe.elements({fonts:[{cssSrc:"https://fonts.googleapis.com/css?family=Open+Sans"}],locale:"auto"});this.card=t.create("card",{style:style,classes:classes,hidePostalCode:!0}),this.card.mount(this.element.querySelector("#card"))},t.prototype.renderPhone=function(){return h("stellar-input",{id:"phone","data-tid":"stellar_stripe.form.phone",type:"tel",placeholder:"(941) 555-0123",required:!0,label:"Phone number"})},t.prototype.renderZip=function(){return h("stellar-input",{id:"zip","data-tid":"stellar_stripe.form.postal_code",type:"text",placeholder:"94107",required:!0,label:"ZIP"})},t.prototype.render=function(){return h("div",null,h("input",{type:"hidden",class:"token",name:this.name,value:this.value}),h("div",{class:"field"},h("label",{"data-for":"stellar_stripe.form.card"},h("p",{class:"label"},"Card details")),h("div",{"data-tid":"stellar_stripe.form.card",id:"card",class:"input"}),this.error&&h("p",{class:"validation"},h("span",null,this.error))),h("stellar-grid",null,this.renderPhone(),this.renderZip()))},Object.defineProperty(t,"is",{get:function(){return"stellar-stripe"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{card:{state:!0},cardData:{state:!0},connect:{method:!0},element:{elementRef:!0},error:{state:!0},getToken:{method:!0},input:{state:!0},name:{type:String,attr:"name"},setError:{method:!0},state:{state:!0},stripe:{state:!0},token:{type:String,attr:"token"},value:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"stellar-stripe{display:block}stellar-stripe .field{position:relative;margin-bottom:30px;width:100%}stellar-stripe label{display:block;margin-bottom:10px;line-height:1.69;color:#484849;color:var(--gray5);font-size:13px;font-weight:600}stellar-stripe .input{border:1px solid var(--gray2);border-radius:4px}stellar-stripe .input::-webkit-input-placeholder{-webkit-transition:color .3s cubic-bezier(.165,.84,.44,1);transition:color .3s cubic-bezier(.165,.84,.44,1);color:transparent}stellar-stripe .input::-moz-placeholder{-webkit-transition:color .3s cubic-bezier(.165,.84,.44,1);transition:color .3s cubic-bezier(.165,.84,.44,1);color:transparent}stellar-stripe .input:-ms-input-placeholder{-webkit-transition:color .3s cubic-bezier(.165,.84,.44,1);transition:color .3s cubic-bezier(.165,.84,.44,1);color:transparent}stellar-stripe .input.StripeElement{display:-ms-flexbox;display:flex;top:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;padding:20px;height:100%}stellar-stripe .input.StripeElement>div{width:100%}stellar-stripe .input.focused::-webkit-input-placeholder,stellar-stripe .input:not(.empty)::-webkit-input-placeholder{color:var(--gray2)}stellar-stripe .input.focused::-moz-placeholder,stellar-stripe .input:not(.empty)::-moz-placeholder{color:var(--gray2)}stellar-stripe .input.focused:-ms-input-placeholder,stellar-stripe .input:not(.empty):-ms-input-placeholder{color:var(--gray2)}stellar-stripe .input.focused+label,stellar-stripe .input:not(.empty)+label{cursor:default;-webkit-transform:scale(.85) translateY(-25px);transform:scale(.85) translateY(-25px);color:#aab7c4}stellar-stripe .input.focused+label{color:#24b47e}stellar-stripe .input.invalid+label{color:#ffa27b}stellar-stripe .input.focused+label+.baseline{background-color:#24b47e}stellar-stripe .input.focused.invalid+label+.baseline{background-color:#e25950}stellar-stripe .input input{appearance:none;-webkit-appearance:none;outline:none;border-style:none;-moz-appearance:none}stellar-stripe .validation{margin-top:10px;margin-bottom:0;color:var(--red5);font-size:14px;font-weight:500}stellar-stripe .validation span{display:block;padding:10px 0;line-height:1.4}stellar-stripe .validation span+span{border-top:1px solid var(--gray1)}"},enumerable:!0,configurable:!0}),t}();export{Card as StellarStripe};